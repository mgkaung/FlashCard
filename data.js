// data.js

const ocr_text = `
Lernwortschatz 5

Alltag
schlafen, er schl√§ft
duschen
besuchen
treffen, er trifft
die Nachricht, -en
die Uni, -s
in die Uni/Schule fahren
die Mensa, Mensen
die Bibliothek, -en
die Musikschule, -n
die Hausaufgabe, -n
die Zeitung, -en
am Computer arbeiten
die Homepage, -s
der Stress (Sg.)

Uhrzeit
die Uhr, -en
wie viel Uhr ist es?
Wie sp√§t ist es?
Es ist vier Uhr.
Es ist Viertel vor vier.
Es ist Viertel nach vier.
Es ist halb f√ºnf.
Es ist kurz vor vier.
Es ist zehn nach vier.
um (um drei Uhr)
die Sekunde, -n
die Minute, -n
die Stunde, -n
eine halbe Stunde
die Versp√§tung, -en
p√ºnktlich
zu sp√§t kommen

Familie
die Familie, -n
der/die Verwandte, -n
das Baby, -s
das Kind, -er
der Junge, -n
das M√§dchen, -
der Sohn, "e
die Tochter, "
die Mutter, "
die Eltern (Pl.)
der Bruder, "
die Schwester, -n
die Geschwister (Pl.)
die Gro√ümutter, "
der Gro√üvater, "
der Opa, -s
die Gro√üeltern (Pl.)
der Mann (mein Mann)
die Frau (meine Frau)
ledig
verheiratet

Termine und Verabredungen
die Zeit, -en
Hast du morgen Zeit?
telefonieren
Auf Wiederh√∂ren.
am (am Montag)
von ... bis (von Montag bis Freitag)
k√∂nnen, er kann
m√ºssen, er muss
wollen, er will
die Party, -s
eine Party machen
die Bar, -s
sitzen
der Kalender, -
die Besprechung, -en
Was kann ich f√ºr Sie tun?

Ich h√§tte gern einen Termin.
Haben Sie am ... einen Termin frei?
Geht es am ... um ...?
Nein, das geht leider nicht.

andere wichtige W√∂rter und Wendungen
krank
der Sport (Sg.)
der Ball, "e
das Motorrad, "er
die Geige, -n
Geige spielen
das Saxofon, -e
die Trompete, -n
der Hund, -e
s√º√ü (Euer Hund ist so s√º√ü.)
die Idee, -n
Gute Idee!
liebe Gr√º√üe
willkommen
cool
falsch
das Problem, -e
die Praxis, Praxen
schade
tut mir leid.
Bitte entschuldigen Sie.
Macht nichts.

Lernwortschatz 6

Freizeitaktivit√§ten
ins Fitness-Studio gehen
klettern
Ski fahren
wandern
der Ausflug, "e
einen Ausflug machen
die Fahrradtour, -en
das Picknick, -s

Feste/Partys
das Fest, -e
feiern
der Geburtstag, -e
werden, er wird (Sie wird 30 Jahre alt.)
schenken
das Geschenk, -e
einladen
das Datum (Sg.)
die √úberraschung, -en
Achtung!
wissen, er wei√ü (Achtung, sie wei√ü nichts.)
mit|bringen
Spa√ü haben
hoffentlich (Hoffentlich kommt ihr.)

eine Mail schreiben
die Mail, -s
schicken
der Betreff, -e
die Anrede, -n
herzliche Gr√º√üe

Speisen und Getr√§nke
die Schorle, -n
das Eis (Sg.)
die Salami, -s
das Schnitzel, -
die Tomatensuppe, -n
der Sandwich, -s

bestellen und bezahlen
der Durst (Sg.)
der Hunger (Sg.)
die Speisekarte, -n
die Bestellung, -en
bestellen
bringen
F√ºr wen ist ...?
bezahlen
zahlen (Zahlen, bitte.)
die Rechnung, -en
Zusammen oder getrennt?
das Trinkgeld (Sg.)
geben, er gibt
Stimmt so.

Auf dem Tisch
die Gabel, -n
das Messer, -
der L√∂ffel, -
das Glas, "er
die Tasse, -n
der Teller, -
die Serviette, -n

Lokale
die Kneipe, -n
das Kaffeehaus, "er
der Biergarten, "
die Bank, "e
die Selbstbedienung (Sg.)
ge√∂ffnet
drau√üen (Man kann drau√üen sitzen.)

Veranstaltungen
das Programm, -e
los sein (Was ist los?)
(keine) Lust haben
mit|kommen
der Treffpunkt, -e
der Eintritt, -e
die Anmeldung, -en
beginnen
enden
die Karte, -n

andere wichtige W√∂rter und Wendungen
ab|holen
an|fangen, er f√§ngt an
an|rufen
auf|h√∂ren
mit|machen
glauben
laufen, er l√§uft
genie√üen
passieren
zu Hause
kalt
warm
wieder
typisch
verboten
√ºberall
besonders (Was ist besonders?)
der Spielplatz, "e
fr√ºh
Alles klar?
Wann denn?
Klingt gut.
`;

const GERMAN_TO_ENGLISH = {
    "Mensch": "person, human being", "Haus": "house", "Rathaus": "town hall, city hall",
    "Konzerthaus": "concert hall", "Kirche": "church", "Fahrrad": "bicycle", "Bus": "bus",
    "Stra√üenbahn": "tram, streetcar", "Zug": "train", "U-Bahn": "subway, underground",
    "S-Bahn": "suburban train", "Schiff": "ship, boat", "Turm": "tower", "Hotel": "hotel",
    "Br√ºcke": "bridge", "Park": "park", "Markt": "market", "Bahnhof": "train station",
    "Hafen": "harbor, port", "See": "lake (der See); sea (die See)", "Fluss": "river",
    "Meer": "sea, ocean", "Station": "station", "Ort": "place, location, town",
    "Meter": "meter", "Kilometer": "kilometer", "Kosten": "costs, expenses",
    "Flugzeug": "airplane", "Fahrkarte": "ticket (for transport)", "Weg": "way, path, route",
    "Mitte": "middle, center", "Plan": "plan, map, schedule", "Start": "start",
    "Ziel": "goal, destination, target", "Euro": "Euro", "Event": "event",
    "Festival": "festival", "Ticket": "ticket (for event)", "Publikum": "audience, public",
    "Besucher": "visitor (male)", "Besucherin": "visitor (female)", "Gast": "guest",
    "Konzert": "concert", "Orchester": "orchestra", "Chor": "choir",
    "Konzertkarte": "concert ticket", "Film": "film, movie", "Schauspieler": "actor",
    "Schauspielerin": "actress", "Star": "star (celebrity)",
    "Regisseur": "director (film/theatre, male)", "Regisseurin": "director (film/theatre, female)",
    "Ausstellung": "exhibition", "Jahreszeit": "season (of the year)", "Fr√ºhling": "spring",
    "Sommer": "summer", "Herbst": "autumn, fall", "Winter": "winter", "Monat": "month",
    "Januar": "January", "Februar": "February", "M√§rz": "March", "April": "April",
    "Mai": "May", "Juni": "June", "Juli": "July", "August": "August",
    "September": "September", "Oktober": "October", "November": "November",
    "Dezember": "December", "Gruppe": "group", "Bild": "picture, image, painting",
    "Plakat": "poster", "Gl√ºck": "luck, happiness", "Test": "test", "Welt": "world",
    "L√∂sung": "solution, answer", "Obst": "fruit (collective)", "Apfel": "apple",
    "Banane": "banana", "Birne": "pear", "Gem√ºse": "vegetables (collective)",
    "Gurke": "cucumber", "Kartoffel": "potato", "Salat": "salad; lettuce",
    "Tomate": "tomato", "Olive": "olive", "Zwiebel": "onion", "Brot": "bread",
    "Br√∂tchen": "bread roll", "Keks": "cookie, biscuit", "Kuchen": "cake, pie",
    "Fleisch": "meat", "Fisch": "fish", "Schokolade": "chocolate",
    "Marmelade": "jam, marmalade", "M√ºsli": "muesli, granola", "Getr√§nk": "drink, beverage",
    "Wasser": "water", "Saft": "juice", "Limonade": "lemonade, soda", "Cola": "cola",
    "Kaffee": "coffee", "Tee": "tea", "B√§ckerei": "bakery", "Metzgerei": "butcher shop",
    "Supermarkt": "supermarket", "H√§hnchen": "chicken (food)", "Packung": "package, pack",
    "Schinken": "ham", "Becher": "cup, beaker, pot (e.g. yogurt pot)", "Wurst": "sausage",
    "Dose": "can, tin", "W√ºrstchen": "small sausage, wiener", "St√ºck": "piece, bit; play (theatre)",
    "Butter": "butter", "T√ºte": "bag (paper/plastic)", "Joghurt": "yogurt",
    "Gramm": "gram", "K√§se": "cheese", "Kilo": "kilo, kilogram", "Milch": "milk",
    "Liter": "liter", "Sahne": "cream", "Pfeffer": "pepper (spice)", "Salz": "salt",
    "Zucker": "sugar", "Essig": "vinegar", "√ñl": "oil", "Nudel": "noodle, pasta",
    "Reis": "rice", "Ei": "egg", "Einkaufswagen": "shopping cart", "Preis": "price; prize",
    "Kassenzettel": "receipt (from store)", "Essen": "food; meal; act of eating",
    "Fr√ºhst√ºck": "breakfast", "Mittagessen": "lunch", "Abendessen": "dinner, supper",
    "Gericht": "dish (food); court (law)", "Suppe": "soup", "Pizza": "pizza",
    "Pommes frites": "french fries", "Morgen": "morning; tomorrow", "Mittag": "midday, noon",
    "Nachmittag": "afternoon", "Abend": "evening", "Nacht": "night",
    "Einladung": "invitation", "Kantine": "canteen, cafeteria",
    // New Vocab from Chapter 5 & 6
    "Nachricht": "message, news", "Uni": "university", "Mensa": "canteen, refectory",
    "Bibliothek": "library", "Musikschule": "music school", "Hausaufgabe": "homework",
    "Zeitung": "newspaper", "Homepage": "homepage", "Stress": "stress",
    "Uhr": "clock, watch, o'clock", "Sekunde": "second", "Minute": "minute", "Stunde": "hour",
    "Versp√§tung": "delay, lateness", "Familie": "family", "Verwandte": "relative", "Baby": "baby",
    "Kind": "child", "Junge": "boy", "M√§dchen": "girl", "Sohn": "son", "Tochter": "daughter",
    "Mutter": "mother", "Eltern": "parents", "Bruder": "brother", "Schwester": "sister",
    "Geschwister": "siblings", "Gro√ümutter": "grandmother", "Gro√üvater": "grandfather",
    "Opa": "grandpa", "Gro√üeltern": "grandparents", "Mann": "man, husband", "Frau": "woman, wife",
    "Zeit": "time", "Party": "party", "Bar": "bar", "Kalender": "calendar", "Besprechung": "meeting",
    "Sport": "sport", "Ball": "ball", "Motorrad": "motorcycle", "Geige": "violin", "Saxofon": "saxophone",
    "Trompete": "trumpet", "Hund": "dog", "Idee": "idea", "Problem": "problem", "Praxis": "practice (doctor's office)",
    "Ausflug": "trip, excursion", "Fahrradtour": "bike tour", "Picknick": "picnic", "Fest": "party, festival",
    "Geburtstag": "birthday", "Geschenk": "gift, present", "Datum": "date", "√úberraschung": "surprise",
    "Mail": "email", "Betreff": "subject (of email)", "Anrede": "salutation, form of address",
    "Schorle": "spritzer (juice mixed with sparkling water)", "Eis": "ice, ice cream", "Salami": "salami",
    "Schnitzel": "schnitzel", "Tomatensuppe": "tomato soup", "Sandwich": "sandwich",
    "Durst": "thirst", "Hunger": "hunger", "Speisekarte": "menu", "Bestellung": "order",
    "Rechnung": "bill, invoice", "Trinkgeld": "tip, gratuity", "Gabel": "fork", "Messer": "knife",
    "L√∂ffel": "spoon", "Glas": "glass", "Tasse": "cup", "Teller": "plate", "Serviette": "napkin",
    "Kneipe": "pub, bar", "Kaffeehaus": "coffee house", "Biergarten": "beer garden", "Bank": "bench",
    "Selbstbedienung": "self-service", "Programm": "program", "Treffpunkt": "meeting point",
    "Eintritt": "admission, entry", "Anmeldung": "registration", "Karte": "card, ticket, map",
    "Spielplatz": "playground"
};

const NOUN_TO_EMOJI = {
    "Mensch": "üßë", "Haus": "üè†", "Rathaus": "üèõÔ∏è", "Konzerthaus": "üé∂", "Kirche": "‚õ™",
    "Fahrrad": "üö≤", "Bus": "üöå", "Stra√üenbahn": "üöã", "Zug": "üöÇ", "U-Bahn": "üöá",
    "S-Bahn": "üöÜ", "Schiff": "üö¢", "Turm": "üóº", "Hotel": "üè®", "Br√ºcke": "üåâ",
    "Park": "üèûÔ∏è", "Markt": "üõí", "Bahnhof": "üöâ", "Hafen": "‚öì", "See": "üåä",
    "Fluss": "üèûÔ∏è", "Meer": "üåä", "Station": "üöâ", "Ort": "üìç",
    "Meter": "üìè", "Kilometer": "üõ£Ô∏è",
    "Kosten": "üí∞", "Flugzeug": "‚úàÔ∏è", "Fahrkarte": "üéüÔ∏è", "Weg": "üõ£Ô∏è",
    "Mitte": "üéØ", "Plan": "üó∫Ô∏è", "Start": "üèÅ", "Ziel": "üéØ", "Euro": "üí∂",
    "Event": "üéâ", "Festival": "üéâ", "Ticket": "üéüÔ∏è",
    "Publikum": "üë•", "Besucher": "üö∂", "Besucherin": "üö∂‚Äç‚ôÄÔ∏è", "Gast": "üëã",
    "Konzert": "üéµ", "Orchester": "üéª", "Chor": "üé§", "Konzertkarte": "üéüÔ∏è",
    "Film": "üé¨", "Schauspieler": "üé≠", "Schauspielerin": "üé≠", "Star": "üåü",
    "Regisseur": "üé¨", "Regisseurin": "üé¨", "Ausstellung": "üñºÔ∏è",
    "Jahreszeit": "üìÖ", "Fr√ºhling": "üå∏", "Sommer": "‚òÄÔ∏è", "Herbst": "üçÇ", "Winter": "‚ùÑÔ∏è",
    "Monat": "üìÖ", "Januar": "‚ùÑÔ∏è", "Februar": "‚õÑ", "M√§rz": "üå∑", "April": "üåßÔ∏è",
    "Mai": "üåº", "Juni": "‚òÄÔ∏è", "Juli": "üèñÔ∏è", "August": "üåû",
    "September": "üçÅ", "Oktober": "üéÉ", "November": "üå¨Ô∏è", "Dezember": "üéÑ",
    "Gruppe": "üë•", "Bild": "üñºÔ∏è", "Plakat": "üì∞", "Gl√ºck": "üçÄ", "Test": "üìù",
    "Welt": "üåç", "L√∂sung": "üí°",
    "Obst": "üçì", "Apfel": "üçé", "Banane": "üçå", "Birne": "üçê",
    "Gem√ºse": "ü•ï", "Gurke": "ü•í", "Kartoffel": "ü•î", "Salat": "ü•ó",
    "Tomate": "üçÖ", "Olive": "ü´í", "Zwiebel": "üßÖ",
    "Brot": "üçû", "Br√∂tchen": "ü•ñ", "Keks": "üç™", "Kuchen": "üç∞",
    "Fleisch": "ü•©", "Fisch": "üêü", "Schokolade": "üç´", "Marmelade": "üçì",
    "M√ºsli": "ü•£", "Getr√§nk": "ü•§", "Wasser": "üíß", "Saft": "üßÉ",
    "Limonade": "ü•§", "Cola": "ü•§", "Kaffee": "‚òï", "Tee": "üçµ",
    "B√§ckerei": "ü•ê", "Metzgerei": "üçñ", "Supermarkt": "üè™",
    "H√§hnchen": "üçó", "Packung": "üì¶", "Schinken": "ü•ì", "Becher": "ü•õ",
    "Wurst": "üå≠", "Dose": "ü•´", "W√ºrstchen": "üå≠", "St√ºck": "üß©",
    "Butter": "üßà", "T√ºte": "üõçÔ∏è", "Joghurt": "üç¶",
    "Gramm": "‚öñÔ∏è", "K√§se": "üßÄ", "Kilo": "‚öñÔ∏è", "Milch": "ü•õ", "Liter": "üíß",
    "Sahne": "üç¶",
    "Pfeffer": "üå∂Ô∏è", "Salz": "üßÇ", "Zucker": "üç¨", "Essig": "üçæ", "√ñl": "ü´í",
    "Nudel": "üçú", "Reis": "üçö", "Ei": "ü•ö",
    "Einkaufswagen": "üõí", "Preis": "üí≤", "Kassenzettel": "üßæ",
    "Essen": "üçΩÔ∏è", "Fr√ºhst√ºck": "ü•û", "Mittagessen": "ü•™", "Abendessen": "üçù",
    "Gericht": "üç≤", "Suppe": "ü•£", "Pizza": "üçï", "Pommes frites": "üçü",
    "Morgen": "üåÖ", "Mittag": "‚òÄÔ∏è", "Nachmittag": "üåá", "Abend": "üåÉ", "Nacht": "üåô",
    "Einladung": "‚úâÔ∏è", "Kantine": "üçΩÔ∏è",
    // New Emojis from Chapter 5 & 6
    "Nachricht": "üí¨", "Uni": "üéì", "Mensa": "üçΩÔ∏è", "Bibliothek": "üìö", "Musikschule": "üéº",
    "Hausaufgabe": "‚úçÔ∏è", "Zeitung": "üì∞", "Homepage": "üåê", "Stress": "ü§Ø",
    "Uhr": "‚è∞", "Sekunde": "‚è±Ô∏è", "Minute": "‚è±Ô∏è", "Stunde": "‚è≥", "Versp√§tung": "üèÉ‚Äç‚ôÇÔ∏èüí®",
    "Familie": "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", "Verwandte": "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", "Baby": "üë∂", "Kind": "üßí", "Junge": "üë¶",
    "M√§dchen": "üëß", "Sohn": "üë¶", "Tochter": "üëß", "Mutter": "üë©", "Eltern": "üë®‚Äçüë©‚Äçüëß",
    "Bruder": "üë®‚Äçüë¶", "Schwester": "üë©‚Äçüëß", "Geschwister": "üëßüë¶", "Gro√ümutter": "üëµ", "Gro√üvater": "üë¥",
    "Opa": "üë¥", "Gro√üeltern": "üëµüë¥", "Mann": "üë®", "Frau": "üë©",
    "Zeit": "‚è≥", "Party": "üéâ", "Bar": "üç∏", "Kalender": "üìÖ", "Besprechung": "üó£Ô∏è",
    "Sport": "‚öΩ", "Ball": "‚öΩ", "Motorrad": "üèçÔ∏è", "Geige": "üéª", "Saxofon": "üé∑",
    "Trompete": "üé∫", "Hund": "üêï", "Idee": "üí°", "Problem": "ü§î", "Praxis": "‚öïÔ∏è",
    "Ausflug": "üèûÔ∏è", "Fahrradtour": "üö¥‚Äç‚ôÄÔ∏è", "Picknick": "üß∫", "Fest": "ü•≥", "Geburtstag": "üéÇ",
    "Geschenk": "üéÅ", "Datum": "üóìÔ∏è", "√úberraschung": "üòÆ", "Mail": "üìß", "Betreff": "·à≠",
    "Anrede": "üëã", "Schorle": "ü•§", "Eis": "üç¶", "Salami": "üçï",
    "Schnitzel": "üçñ", "Tomatensuppe": "ü•£", "Sandwich": "ü•™", "Durst": "üíß", "Hunger": "üòã",
    "Speisekarte": "üìú", "Bestellung": "üõçÔ∏è", "Rechnung": "üßæ", "Trinkgeld": "üí∞",
    "Gabel": "üç¥", "Messer": "üî™", "L√∂ffel": "ü•Ñ", "Glas": "ü•õ", "Tasse": "‚òï",
    "Teller": "üçΩÔ∏è", "Serviette": "üßª", "Kneipe": "üçª", "Kaffeehaus": "‚òï", "Biergarten": "üç∫üå≥",
    "Bank": "üè¶", "Selbstbedienung": "üôã‚Äç‚ôÇÔ∏è", "Programm": "üíª", "Treffpunkt": "üìç",
    "Eintritt": "üéüÔ∏è", "Anmeldung": "üìù", "Karte": "üÉè", "Spielplatz": "üé†"
};


function parseOcrToFlashcards(text) {
    const flashcards = [];
    const lines = text.split('\n');
    const articleRegex = /^(der|die|das|der\/das)\s+([A-Z√ñ√Ñ√ú][a-zA-Z√∂√§√º√ü]+.*?)(?:,\s*(.*?))?$/;
    const noCommaPluralRegex = /^(der|die|das|der\/das)\s+([A-Z√ñ√Ñ√ú][a-zA-Z√∂√§√º√ü]+)\s+\((PL\.|Sg\.)\)/;

    for (const line of lines) {
        const trimmedLine = line.trim();
        if (!trimmedLine) continue;

        let article, nounPartWithDetails, pluralPartRaw;
        let match = trimmedLine.match(articleRegex);

        if (match) {
            article = match[1];
            nounPartWithDetails = match[2].trim(); // This is the part after the article, up to the comma
            pluralPartRaw = match[3] ? match[3].trim() : null;
        } else {
            match = trimmedLine.match(noCommaPluralRegex);
            if (match) {
                article = match[1];
                // Reconstruct nounPartWithDetails to include the (Sg.) or (Pl.) tag for consistency
                nounPartWithDetails = `${match[2].trim()} (${match[3]})`;
                pluralPartRaw = null; // Plural info is now part of nounPartWithDetails
            } else {
                continue; // Not a noun line we can parse in either format
            }
        }

        // Clean noun_base: remove (Sg.), (Pl.), (g), (kg), (l) from the end
        let nounBase = nounPartWithDetails.replace(/\s*\((Sg\.|Pl\.|g|kg|l|PL\.)\)$/, '').trim();
        // Second pass if the tag was not at the very end but part of nounPartWithDetails from noCommaPluralRegex
        nounBase = nounBase.replace(/\s*\((Sg\.|Pl\.|PL\.)\)$/, '').trim();


        let pluralDisplayText = "";
        if (pluralPartRaw === null) { // No comma, plural info might be in nounPartWithDetails
            if (nounPartWithDetails.includes("(Sg.)")) pluralDisplayText = "(Singular only)";
            else if (nounPartWithDetails.includes("(Pl.)") || nounPartWithDetails.includes("(PL.)")) {
                pluralDisplayText = "(Plural only)";
            } else pluralDisplayText = "-"; // Default if no info
        } else { // Plural info came after a comma
            pluralDisplayText = pluralPartRaw;
            if (pluralDisplayText === "=") pluralDisplayText = "¬®e"; // For Markt
        }

        // Handle OCR quote for umlaut
        if (pluralDisplayText && pluralDisplayText.startsWith('"')) {
            pluralDisplayText = "¬®" + pluralDisplayText.substring(1);
        }
        // Specific OCR artifact corrections based on previous Python logic
        if (nounBase === "Haus" && pluralDisplayText === "er") pluralDisplayText = "¬®er";
        else if (nounBase === "Rathaus" && pluralDisplayText === "er") pluralDisplayText = "¬®er";
        else if (nounBase === "Konzerthaus" && pluralDisplayText === "er") pluralDisplayText = "¬®er";
        else if (nounBase === "Fahrrad" && pluralDisplayText === "er") pluralDisplayText = "¬®er"; // Note: OCR was "er", not ""er"
        else if (nounBase === "Apfel" && pluralDisplayText === "¬®") pluralDisplayText = "¬®"; // OCR "
        else if (nounBase === "Nacht" && pluralDisplayText === "e") pluralDisplayText = "¬®e"; // OCR "e
        

        // Basic validation
        if (!nounBase || nounBase.toLowerCase() === nounBase || nounBase.split(' ').length > 3) continue;
        if (nounBase.includes('(') && !nounBase.includes(')')) continue; // Unclosed parenthesis
        if (nounBase.includes('...') || nounBase.includes('?')) continue; // Likely not a noun

        let fullInfoGerman = `${article} ${nounBase}`;
        if (pluralDisplayText && pluralDisplayText !== "(Singular only)" && pluralDisplayText !== "(Plural only)" && pluralDisplayText !== "-") {
            fullInfoGerman += `, Pl: ${pluralDisplayText}`;
        } else if (pluralDisplayText && (pluralDisplayText === "(Singular only)" || pluralDisplayText === "(Plural only)")) {
            fullInfoGerman += ` ${pluralDisplayText}`;
        } else if (pluralDisplayText === "-") {
             // Optionally add ", Pl: -" or just leave it if "-" means no change / not specified often
        }
        
        const englishMeaning = GERMAN_TO_ENGLISH[nounBase] || "Meaning not available";
        const emoji = NOUN_TO_EMOJI[nounBase] || "";

        flashcards.push({
            id: nounBase, // Use nounBase as a unique ID for the card
            front_display: nounPartWithDetails, 
            noun_base_for_lookup: nounBase,
            article: article,
            plural_form_raw: pluralDisplayText, // This will be used to construct the display plural
            full_info_german: fullInfoGerman,
            english_meaning: englishMeaning,
            emoji: emoji
        });
    }

    // Remove duplicates based on 'id' (noun_base_for_lookup)
    const uniqueFlashcards = [];
    const seenIds = new Set();
    for (const card of flashcards) {
        if (!seenIds.has(card.id)) {
            uniqueFlashcards.push(card);
            seenIds.add(card.id);
        }
    }
    // console.log("Parsed Flashcards:", uniqueFlashcards); // For debugging
    return uniqueFlashcards;
}

// This function will be called by script.js to get the processed flashcard data
function getFlashcardData() {
    return parseOcrToFlashcards(ocr_text);
}
